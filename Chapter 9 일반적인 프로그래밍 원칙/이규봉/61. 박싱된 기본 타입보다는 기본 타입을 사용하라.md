# 아이템 61. 박싱된 기본 타입보다는 기본 타입을 사용하라

## 자바의 데이터 타입
* 자바의 데이터 타입은 크게 두 가지로 나눌 수 있다.
* int, double, boolean 같은 `기본 타입`과 String, List `같은 참조 타입`이다.
* 그리고 각각의 기본 타입에 대응하는 참조 타입이 하나씩 있는데, 이를 `박싱된 기본 타입`이라고 한다.

<br>

## 기본 타입 vs. 박싱된 기본 타입
* `오토박싱`과 `오토언박싱` 덕분에 두 타입을 크게 구분하지 않고 사용 가능하나, 그렇다고 차이가 사라진 것은 아니다.
### 1. 기본 타입은 값만 가지고 있으나, 박싱된 기본 타입은 값에 더해 identity 속성도 갖는다.
* 박싱된 기본 타입의 두 인스턴스는 값이 같아도 서로 다르다고 식별될 수 있다.
### 2. 기본 타입의 값은 언제나 유효하나, 박싱된 기본 타입은 유효하지 않은 값, 즉 null을 가질 수 있다.
* JPA 사용 시 엔티티의 id 타입을 `박싱된 기본 타입`을 사용하는데, 이는 `null`을 포함하기 위해서이다.
* 기본 타입의 경우 초기값이 0인데, id 타입으로 long(기본 타입)으로 지정했을 경우 실제로 사용하는 id 값이 없는 것인지, 0인건지 구분할 수 없게 된다.
* 이 때, Long(박싱된 기본 타입)을 사용하게 되면 id가 0인지 없는 것인지 null을 통해 명확하게 구분할 수 있게 된다.
* 즉, id에 null을 할당함으로써 id 값이 없다는 것을 보장할 수 있게 된다.
* Hibernate 공식 문서에도 DB와 상호작용 시 값의 존재 여부를 명확하게 구분할 수 있는 Long 타입을 사용하라고 나와있다고 한다.
### 3. 기본 타입이 박싱된 기본 타입보다 시간과 메모리 사용면에서 더 효율적이다.

<br>

## 박싱된 기본 타입을 사용할 시 주의 사항
### 1. 객체 값 비교

```java
String str1 = "str";
String str2 = "str";

System.out.println(str1 == str2); // false
System.out.println(str1.eqauls(str2)); // true
```

* 위에서 말했듯이 박싱된 객체 타입은 `identity` 를 갖는다.
* 따라서, 객체의 동일성을 비교하는 `==` 연산자로 두 객체를 비교할 때 두 객체의 id가 다르므로 false 가 반환된다.
* 번외로, enum 타입은 클래스 내부에서 정의된 인스턴스 이외의 인스턴스가 존재할 수 없다. 따라서, 두 enum 객체를 비교할 때 `equals()` 대신 `==` 연산자를 사용할 수 있다.

```java
Mbti mbti1 = Mbti.ESTJ;
Mbti mbti2 = Mbti.ESTJ;

System.out.println(mbti1 == mbti2); // true
```
* 추가적으로 `==` 연산자를 사용하면 `null` 에 대하여 더 안전하다.

```java
Mbti mbti1 = null;
Mbti mbti2 = Mbti.ESTJ;

System.out.println(mbti1 == mbti2); // false
System.out.println(mbti1.equals(mbti2)); // NPE
```

### 2. 성능

```java
Long sum = 0L;

for (long i = 0; i <= Integer.MAX_VALUE; i++) {
    sum += i; // 끔찍이 느리다!
}
```
* 이 프로그램은 지역변수 sum을 박싱된 기본 타입으로 선언했다.
* 오류나 경고 없이 컴파일 되지만, 박싱과 언박싱이 반복해서 일어나 체감될 정도로 성능이 느려진다.

<br>

## 박싱된 기본 타입은 그럼 언제 써야 하는가?
### 1. 컬렉션의 원소, 키, 값으로 사용
* 컬렉션은 기본 타입을 담을 수 없으므로 어쩔 수 없이 박싱된 기본 타입을 사용해야 한다.
### 2. 제네릭 타입을 이용하는 경우
* 제네릭 타입에서는 int, double과 같은 기본 타입을 지원하지 않는다.
### 3. 리플렉션을 통해 메서드를 호출할 경우

<br>

## 정리
* 박싱된 기본 타입을 사용해야 하는 경우가 아니라면 기본 타입을 사용하자. 간단하고 빠르다.
* 박싱된 기본 타입을 사용해야 한다면 두 객체의 비교, 성능 등 주의를 기울이자.