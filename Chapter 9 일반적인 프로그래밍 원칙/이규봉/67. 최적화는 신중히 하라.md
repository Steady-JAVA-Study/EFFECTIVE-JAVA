# 아이템 67. 최적화는 신중히 하라

## 설계 단계에서 성능을 고려하자
* 프로그램의 구현상의 성능 이슈는 나중에 최적화로 해결할 수 있지만, 아키텍처의 결함이 성능을 해치는 상황이라면 시스템 전체를 다시 만들지 않고서는 해결이 불가능할 수 있다.
* 따라서, 설계 단계에서 성능을 반드시 염두해 두어야 한다.

<br>

## 설계 시 주의 사항
### 성능을 제한하는 설계는 피하자.
* `API`, `네트워크 프로토콜`, `영구 저장용 데이터 포맷` 등의 부분은 완성 후 변경하기 어렵기 때문에 성능을 제한하지 않는 설계가 필요하다.

### API를 설계할 때 성능에 주는 영향을 고려하자.
* `public` 타입을 가변으로 만들어 내부 데이터를 변경할 수 있다면, 불필요한 방어적 복사를 유발할 수 있다.
* `상속`대신 `컴포지션`으로 해결할 수 있다면 이를 활용하자.
* 특정 구현체에 종속되지 않도록 `인터페이스`를 사용하자.
* 성능을 위해 API를 왜곡하지 말자.

<br>

## 정리
* 빠른 프로그램을 작성하려 하기보다는 좋은 프로그램을 만들자. 
* 좋은 프로그램을 만들다 보면 성능은 자연스럽게 따라온다. 
* 시스템 설계 시, 특히 API, 네트워크 프로토콜, 영구 저장용 데이터 포맷을 설계할 때는 성능을 고려해야 한다. 
* 시스템을 완성했다면 성능을 측정하자. 충분히 빠르다면 최적화할 필요가 없다. 
* 최적화를 고려해야 하는 상황이라면 프로파일러를 사용해 원인이 되는 지점을 찾아 최적화를 수행하자.